# 🚀 NYT Connections 静态文章生成系统部署指南

## 📋 系统概述

这个系统会自动从你的 Cloudflare Pages 网站获取 NYT Connections 文章数据，生成静态 HTML 文件，并通过 GitHub Actions 自动部署。

## ✅ 已完成的配置

### 1. 静态文章生成脚本 ✅
- **文件**: `generate-static-articles.js`
- **功能**: 
  - 从 API 获取最近30天的文章数据
  - 生成静态 HTML 文件到 `articles/` 目录
  - 创建文章索引页面 `articles/index.html`
  - 生成 SEO 优化的 `sitemap.xml`
- **测试状态**: ✅ 已测试通过，成功生成9篇文章

### 2. GitHub Actions 工作流 ✅
- **文件**: `.github/workflows/generate-static-articles.yml`
- **触发方式**:
  - 🕐 **自动**: 每天北京时间 12:30 (UTC 04:30)
  - 🖱️ **手动**: GitHub Actions 页面手动触发
- **执行流程**:
  1. 检出代码
  2. 设置 Node.js 环境
  3. 安装依赖
  4. 运行生成脚本
  5. 检查文件变化
  6. 自动提交和推送更新

## 🎯 部署步骤

### 步骤 1: 推送代码到 GitHub
```bash
git add .
git commit -m "Add static article generation system"
git push origin main
```

### 步骤 2: 启用 GitHub Actions
1. 进入你的 GitHub 仓库
2. 点击 **Actions** 标签页
3. 如果看到工作流被禁用，点击 **Enable workflow**
4. 确认看到 "Generate Static Articles" 工作流

### 步骤 3: 手动测试工作流
1. 在 Actions 页面，点击 "Generate Static Articles"
2. 点击 **Run workflow** 按钮
3. 选择分支 (通常是 main)
4. 点击绿色的 **Run workflow** 按钮
5. 等待执行完成 (大约2-3分钟)

### 步骤 4: 验证生成结果
执行成功后，检查：
- `articles/` 目录包含生成的 HTML 文件
- `articles/index.html` 文章索引页面
- `sitemap.xml` 更新了新的文章链接

## 📊 系统特性

### 🔄 自动化流程
- **数据获取**: 从 `https://nyt-connections-helper.pages.dev/api/article/[date]` 获取
- **文件生成**: 每篇文章生成独立的 HTML 文件
- **SEO 优化**: 自动添加 canonical URL、meta 标签
- **索引页面**: 美观的文章列表页面
- **站点地图**: 自动更新 sitemap.xml

### 🎨 生成的文件结构
```
articles/
├── index.html              # 文章索引页面
├── 2025-09-19.html        # 单篇文章页面
├── 2025-09-18.html
├── 2025-09-17.html
└── ...
sitemap.xml                 # 更新的站点地图
```

### 🔍 SEO 优化功能
- **Canonical URLs**: 防止重复内容
- **Meta 标签**: 完整的 description、keywords
- **Open Graph**: 社交媒体分享优化
- **Robots Meta**: 搜索引擎索引控制
- **Sitemap**: 自动更新站点地图

## 🛠️ 配置选项

### 环境变量
在 GitHub Actions 中已配置：
- `CLOUDFLARE_API_URL`: https://nyt-connections-helper.pages.dev

### 可调整参数
在 `generate-static-articles.js` 中：
```javascript
const DAYS_TO_GENERATE = 30; // 生成最近30天的文章
```

### 定时配置
在 `.github/workflows/generate-static-articles.yml` 中：
```yaml
schedule:
  - cron: '30 4 * * *'  # UTC 04:30 = 北京时间 12:30
```

## 📈 监控和维护

### 查看执行日志
1. GitHub 仓库 → Actions 标签页
2. 点击具体的工作流运行
3. 查看详细的执行日志

### 常见问题排查
- **API 请求失败**: 检查 Cloudflare Pages 网站是否正常
- **文件生成失败**: 查看 Actions 日志中的错误信息
- **推送失败**: 检查仓库权限设置

### 成功指标
- ✅ 每天自动执行
- ✅ 生成新的文章文件
- ✅ 更新 sitemap.xml
- ✅ 自动提交到 GitHub

## 🎉 使用效果

### 用户访问路径
1. **文章索引**: `https://your-site.com/articles/`
2. **单篇文章**: `https://your-site.com/articles/2025-09-19.html`
3. **搜索引擎**: 通过 sitemap.xml 自动发现新内容

### SEO 收益
- 📈 更好的搜索引擎收录
- 🔗 清晰的 URL 结构
- 📱 移动端友好的页面
- ⚡ 快速的页面加载速度

## 🔧 故障排除

### 如果工作流失败
1. 检查 Actions 页面的错误日志
2. 确认 API 端点是否可访问
3. 验证 Node.js 依赖是否正确安装

### 如果没有生成文件
1. 检查 API 是否返回有效数据
2. 确认日期范围内有可用文章
3. 查看脚本执行日志

### 手动重新生成
如需手动重新生成所有文章：
```bash
node generate-static-articles.js
```

## 📞 支持

如果遇到问题：
1. 查看 GitHub Actions 执行日志
2. 检查本地测试是否正常: `node test-static-article-generation.js`
3. 确认 API 端点响应正常

---

🎯 **系统已就绪！** 现在你的 NYT Connections 网站将自动生成和维护静态文章档案，提供更好的 SEO 和用户体验。